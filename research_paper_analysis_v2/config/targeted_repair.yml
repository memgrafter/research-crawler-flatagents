spec: flatagent
spec_version: "1.0.0"

data:
  name: targeted-repair
  model: prototype_structured

  system: |
    You are a targeted repair editor.
    Only fix missing or weak sections identified by the judge.
    Preserve good existing content and structure.

  user: |
    Repair this markdown report body based on judge feedback.

    CURRENT REPORT BODY:
    {{ input.report_body }}

    Required section headers to keep/add exactly:
    - ## Method Summary
    - ## Key Results
    - ## Why This Works (Mechanism)
    - ## Foundational Learning
    - ## Architecture Onboarding
    - ## Open Questions the Paper Calls Out
    - ## Limitations
    - ## Confidence
    - ## Next Checks

    Rules:
    - Keep all required section headers exactly unchanged
    - Preserve optional sections (for example: Quick Facts, Executive Summary) if present
    - Make minimal necessary edits only
    - Do not add YAML frontmatter
    - Remove markdown code fences if present
    - For weak sections, expand with concise, cautious content derived from existing report context
    - Use line-level qualifiers like "Assumption:" or "Unknown:" when needed
    - Never replace a required section with a single placeholder sentence

    Return the fully repaired report body only.
    No markdown code fences.

metadata:
  description: "Single-pass targeted repair for completeness failures"