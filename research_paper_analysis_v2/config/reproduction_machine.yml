spec: flatmachine
spec_version: "1.0.0"

data:
  name: reproduction
  profiles: ./profiles.yml

  agents:
    writer: ./reproduction_writer.yml

  context:
    # Capture inbound machine input into local context (required for agent input mapping)
    title: input.title
    key_outcome: input.key_outcome
    abstract: input.abstract
    paper_text: input.paper_text
    reference_count: input.reference_count
    token_target_reproduction: input.token_target_reproduction

    result: null

  states:
    start:
      type: initial
      transitions:
        - to: write

    write:
      agent: writer
      execution:
        type: default
      input:
        title: context.title
        key_outcome: context.key_outcome
        abstract: context.abstract
        paper_text: context.paper_text
        reference_count: context.reference_count
        token_target: context.token_target_reproduction
      output_to_context:
        result: output.content
      transitions:
        - to: done

    done:
      type: final
      output:
        content: context.result

metadata:
  description: "Wrapper machine for reproduction_writer (expensive model)"
